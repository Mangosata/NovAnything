import{_ as e}from"./bot-avatar-CBCRm2Zm.js";import{_ as a}from"./knowledge-zhu8jsrY.js";import{u as t}from"./useBots-CpcdgWbc.js";import{u as l,b as s,a as o,c as n}from"./urlConfig-BRkfAQUm.js";import{r as i,C as c,t as r}from"./utils-Dy9G1Irh.js";import{g as u,u as d}from"./index-BGs17W_C.js";import{a as p,C as m}from"./ChatSettingDialog-B--LcsYW.js";import{u as v}from"./useChatSetting-BAUL9MYY.js";import{u as g}from"./useBotsChat-CAp_Tb2G.js";import{d as h,K as f,v as k,x as A,E as w,a as b,b as y,c as C,f as _,e as S,M as x,O as I,Z as B,$ as j,g as T,Q as F,R as D,B as R,w as L,j as q,o as U,p as O,i as E,l as H,C as Q,U as V,L as K,N as z,S as Y,n as M,D as X,T as Z,a6 as W,V as P,y as N}from"./index-Dnd1wrVz.js";import{_ as G}from"./ai-avatar-DDzLUhUE.js";import{u as J,a as $,D as ee,T as ae,f as te,h as le,C as se,_ as oe}from"./ChatInfoPanel-FjtXze9J.js";import{_ as ne}from"./lock-DmQwPPsI.js";import{u as ie,_ as ce,I as re}from"./useChatSource-BAwYmxq4.js";import{C as ue}from"./ChatTextarea-C9n-wMxD.js";import"./index-Wcu94PXT.js";import"./index-BOQF8sB2.js";import"./responsiveObserve-DBZcF5T1.js";import"./collapseMotion-SidVLewu.js";import"./class-FJ4HjPo2.js";import"./index-DI3wlhMT.js";import"./slide-emAtT-ep.js";import"./LeftOutlined-CbcobKim.js";import"./CheckOutlined-BY4Hd7YC.js";import"./index-b0BYlB-E.js";import"./index-DxXpsklO.js";import"./RightOutlined-BOg6omYT.js";const de=e=>(O("data-v-a73457f9"),e=e(),E(),e),pe={class:"bot-detail-edit-comp"},me={class:"name-avatar"},ve=de((()=>y("img",{src:e,alt:"avatar"},null,-1))),ge={class:"title"},he={class:"title"},fe={class:"title"},ke=de((()=>y("span",null,"*",-1))),Ae=de((()=>y("img",{class:"knowledge-icon",src:a,alt:"knowledge"},null,-1))),we={class:"kb-name"},be=["onClick"],ye=de((()=>y("img",{class:"add-knowedge",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAOBSURBVFiFzZixdeJAEIb/WZAiAjqADiiBwAUQOHOg97BlhQQUQEABBIRCZ7+ngMwBBThQARfQgegAv4cTOHYuuFksQBJIYM5/AojVzqcZ7ezsEDNX8IOl/jfAKVUvuTkMw/p6vW4TUUNrXWfmBgAQ0UIptWTmhW3bkeM4y7I2qGiIwzCsbzYbZ7vddoioxcz1k0aIZkQ0c103/FZA3/d7RDQwUES0ZOY5gDkRLYkoBgBmbsqYFoB2YopYKTUsAnoW4Ovra2uz2bwBaMqlSCk1Pid85jXQWvcSsHGtVrt7eHhYXAwYBIHDzCPxSCQeiE5NnDWX1noAoCkef3Jdd1YacDKZDJh5ID/Hnuf1y4Adyvf9EYAeABDR8Pn5eVgYMAiCjtb6TX72Pc8bXwPOKPnwSqnHrPcyFXA6nTY+Pz9/M3P91BNeIt/3ewBGRLSsVqt33W53fjgmNVGvVqt3eefG3wUHABKVMTPXZREe6QgwCAIH/1ZrfK13Lk9iIwLQFI/mA8oqg1KqsOeCIHDSjJySsUVEgzAM9xL/HmDCe1GZrK+1fgEwKnqfpK1IQu1kAjJzBwCUUlddsefI2Nxut5296+ZLGIZ1A2jbdqlEfIls244kebeSYd4Brtdrsw1dVH2UleM4S2aeM3M9wfIFSEQN+XqUi26o+QHLF6DWeleh3J7rn4xtwwIkCtZEsRnnTSIb/kveGN/3/2T8lbtlElHMzDsWoETJn3y6olJKFY7OzoNEtBD6Zt4NZntK+894zvO8UkcJY5uIdnVicpHEMqi0hy6VsZ30dDLEH/LZuiXUgVoAwMzHHsxKlLeS2GwbliPArER5KxmbRDRLbhR7q7hSqcwAQA44N5WxSUR7Z5Q9QMuyQkmW7SAIynixr5R6LHqTVFFtAPFhFbUHKGEeAl91YRF5njcuWaZl1qBHiVryXAygLaevb5XYaCLFe6mAAGBZ1r2EulemQj5Xk8lkAKBHRMtarXaXNiYVsNvtzonInEdGMtFV5ft+zxw7iegpq8uQuRe7rhsS0RAAmHlwzXDLXCOBG+Z1F85pfXSY+ZdsQ4WbPwdztWVBtGVT6J+a66zm0XQ6baxWq3dcsXlkWdZ92kG9FKBRsvmTuBwhp/2W7CFKu25YpI1SuIFpQJm5Yw5ZuQakh1ipVGaWZYVFzzulAI3yWsDizY+bt4BvrR/f5f8LxA8rSSHVBD4AAAAASUVORK5CYII=",alt:"icon"},null,-1))),Ce={class:"title"},_e={class:"chat-setting-form-footer"},Se=H(h({__name:"BotDetailEdit",setup(e,{expose:a}){const{curBot:s,knowledgeList:o}=f(t()),{QA_List:n}=f(g()),{setSelectKnowledgeVisible:c,setCurBot:r}=t(),{setChatSettingConfigured:d}=v(),{chatSettingFormActive:m}=f(v()),{bots:h,common:O}=u(),E=k(""),H=k(""),Q=k(""),V=A((()=>H.value.match(/[^a-zA-Z\s]|\p{P}|\w+/g)));w((()=>{E.value=s.value.bot_name,Q.value=s.value.welcome_message,H.value=s.value.prompt_setting}));const K=async e=>{try{const a=await i(await l.queryBotInfo({bot_id:e}));r(a[0])}catch(a){q.error(a.msg||"获取Bot信息失败")}},z=k(),Y=async(e,a="应用成功")=>{const t=await z.value.onCheck();return!Object.hasOwn(t,"errorFields")&&(await(async()=>{try{await i(await l.updateBot({bot_id:s.value.bot_id,bot_name:E.value,prompt_setting:H.value,welcome_message:Q.value,only_need_search_results:m.value.capabilities.onlySearch,networking:m.value.capabilities.networkSearch,api_base:m.value.apiBase,api_key:m.value.apiKey,api_context_length:m.value.apiContextLength,top_p:m.value.top_P,temperature:m.value.temperature,top_k:m.value.top_K,model:m.value.apiModelName,max_token:m.value.maxToken,hybrid_search:m.value.capabilities.mixedSearch,chunk_size:m.value.chunkSize,rerank:m.value.capabilities.rerank})),await K(s.value.bot_id)}catch(e){q.error(e.msg||"保存失败，请重试")}})(),d(t),q.success(a),!0)};return a({handleOk:Y}),(e,a)=>{const t=_,r=B,u=R;return U(),b("div",pe,[y("div",me,[ve,C(t,{value:S(E),"onUpdate:value":a[0]||(a[0]=e=>x(E)?E.value=e:null),placeholder:S(h).inputBotName,"show-count":"",maxlength:25},null,8,["value","placeholder"])]),y("div",ge,I(S(h).roleSetting),1),C(r,{value:S(H),"onUpdate:value":a[1]||(a[1]=e=>x(H)?H.value=e:null),class:"role-setting-input","auto-size":{minRows:7,maxRows:7},rows:7},null,8,["value"]),y("div",{class:j(["role-setting-length",S(V)&&S(V).length>2e3?"over-length":""])},I(S(V)?S(V).length:0)+" / 2000 ",3),y("div",he,I(S(h).welcomeMessage),1),C(r,{value:S(Q),"onUpdate:value":a[2]||(a[2]=e=>x(Q)?Q.value=e:null),class:"greeting-input","show-count":"",maxlength:100,placeholder:S(h).inputWelcomMsg,"auto-size":{minRows:6,maxRows:6},rows:6},null,8,["value","placeholder"]),y("div",fe,[T(I(S(h).associatedKb),1),ke]),(U(!0),b(F,null,D(S(s).kb_ids,((e,a)=>(U(),b("div",{key:e,class:"knowedge-item knowledge-info"},[Ae,y("div",we,I(S(s).kb_names[a]),1),y("img",{class:"remove-icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAQBSURBVFiF1Zk/aBtnFMB/73TWUJwUi0CoS4KHxEPw4n+0aQMpGWwPLaQYeywt0l0OFxwC7ZohawuhHoR9Z2jwaFEayFDbgyGQ4BaEp5DBWURCFZoauSTOoujuZdB3RpKNY8e25P4m6b67e7+7033fe0/C+yGO41wErgADItINdAInzPgroKiqa0AeWA6CYAXQfQfaz86u655V1QkR+Qb4aJ+xnqvqnIhkfd9/eqiCmUzmdCKRuKmqDtBmNj8BFkXkgao+LpfLz7q6ul4CFAqFk8lk8oyIXFDVS8AwcN4c90ZEgjAMb83Ozv5zYEHHcb4VkZ+AU0AFmAemfN//ay8XF+O67ifAJDAO2MC6qv4YBMGd9xIcGxtLplKp26o6YTYtqOr1IAjW9iPWiOM43SLyCzACICLZUql0I5fLlfcsODEx0V6pVH4DhoBN4Aff92cOItaI67rXgJ+BdmDJtu3RbDa7+U7BsbGxZEdHxz1gSFWLiURieHp6+tFhysV4ntcThuGiiHQCSxsbG1813kmr8aBUKnU7loui6PJRyQFMT08/iqLosqoWgSETu466O2heiF+BTcuyLh6lXC2e5/VEUbQCtKvqd7UvTiL+kMlkTluWdRf4AJicmZn5oxlyAPl8/kV/f38J+FJELvX29s6trq6+hppHnEgkblKdShYO+4XYCybmAnDKuLAlaFYIB6io6vVmy8WY2BVVdVzXPbslaOa6NmD+oPPcQTCx54G2eP61ADFrK8BUq+RqmAIwTiKO43wmIg+BJ77vd7fWrYrrumvAeVX93KKaMgEsttCpkdjligUMAIjIg9b51FPjMmCZZBNVfdxCpzpiFxHptqhmwpTL5WcttaqhxqXTxqTpcbK5G67r/g5cPWD8u77vf73bDl1dXS+LxSLAiW3JwnHDplrgfFgoFE4C/+2287uu/LAwJQPAKwsoAiSTyTPNCL4XalyKlikNEZELLXSqI3ZR1TWLat2Kqb6OBTUueQtYNl+GW+SzE7HLsgDiuu7fVAvxT/dbTh42pjz9E3ju+/7HFqCqOmfGJ1untsUkgHFSC6q1KfAGGHccp2UZjYk9TrX7kAWTsPq+/1REAsA2RXVLMLFtEQni/s3WShKG4S1gHRgxRXVTMTFHgHXjAtRUdaurq6/7+vr+FZGrwBeDg4P38vn8i2bIeZ7Xo6rzQFJVv5+dnX0Yj9WtxUEQ3DHPvj0Mw8V0On3uqOXS6fS5MAwXgXYRyTY2k7YlC6VS6QawJCKdlmXd9zyv56jkPM/rsSzrftz6MLHr2CaYy+XKtm2PxpJRFK0cxW/Sdd1rURStxHK2bY/u1OH6f7bfGk54PBuYtRzrFnAtx7aJvtNxzfob4i2ESvnrjyWOcQAAAABJRU5ErkJggg==",alt:"remove",onClick:a=>(async e=>{let a=s.value.kb_ids;a=a.filter((a=>a!=e));try{await i(await l.updateBot({bot_id:s.value.bot_id,kb_ids:a})),K(s.value.bot_id),o.value=o.value.map((a=>(a.kb_id===e&&(a.state=0===a.state?1:0),a))),q.success(h.removalSucessful)}catch(t){q.error(t.msg||"请求失败")}})(e)},null,8,be)])))),128)),y("div",{class:"knowedge-item add-knowledge-content",onClick:a[3]||(a[3]=e=>S(c)(!0))},[ye,T(" "+I(S(h).clickAssociatedKb),1)]),y("div",Ce,I(S(O).modelSettingTitle),1),C(p,{ref_key:"chatSettingFormRef",ref:z,"context-length":S(n).length},null,8,["context-length"]),y("div",_e,[C(u,{type:"primary",style:{width:"auto"},onClick:Y},{default:L((()=>[T(I(S(O).confirmApplication),1)])),_:1})])])}}}),[["__scopeId","data-v-a73457f9"]]),xe=e=>(O("data-v-572ca94d"),e=e(),E(),e),Ie={class:"bots-chat-container"},Be={class:"my-page"},je={class:"header"},Te=xe((()=>y("img",{src:e,alt:"avatar"},null,-1))),Fe={id:"chat",class:"chat"},De={class:"ai"},Re={class:"content"},Le=xe((()=>y("img",{class:"avatar",src:G,alt:"头像"},null,-1))),qe=["innerHTML"],Ue={key:0,class:"user"},Oe=xe((()=>y("img",{class:"avatar",src:oe,alt:"头像"},null,-1))),Ee={class:"question-text"},He={key:1,class:"ai"},Qe={class:"content"},Ve=xe((()=>y("img",{class:"avatar",src:G,alt:"头像"},null,-1))),Ke={key:1},ze={key:0},Ye={key:1},Me={class:"source-list"},Xe={class:"control"},Ze={class:"tips"},We=["href"],Pe=["onClick"],Ne={class:"source-content"},Ge=["innerHTML"],Je={class:"score"},$e={class:"tips"},ea={key:2,class:"feed-back"},aa=["onClick"],ta={class:"reload-text"},la={class:"tools"},sa={class:"stop-placeholder"},oa={class:"question-box"},na={class:"question"},ia={key:0,class:"mask"},ca=xe((()=>y("img",{src:ne,alt:"icon"},null,-1))),ra=H(h({__name:"Chat",props:{chatType:{type:String,default:"edit"},botInfo:{type:Object,default:()=>{}}},setup(e){const a=e,t=u().common,p=u().bots,h=new ae((e=>{e&&(_.value[_.value.length-1].answer+=e||"")})),{QA_List:_}=f(g()),{chatSettingFormActive:B}=f(v()),{copy:O}=J(),{setChatSourceVisible:E,setSourceType:H,setSourceUrl:N,setTextContent:G}=ie(),{language:oe}=f(d()),ne=k(""),de=A((()=>{const e=B.value.context;if(0===e)return[];const a=_.value.filter((e=>"ai"===e.type));return(11===e?a:a.slice(-e)).map((e=>[e.question,e.answer]))})),pe=k(!1),me=k([]);let ve;const ge=k(null),he=k(null),fe=()=>{M((()=>{var e;null==(e=ge.value)||e.scrollIntoView(!1)}))},ke=r(((e,a)=>{if(e.like=!e.like,e.unlike=!1,e.like){a.target.parentNode.style.animation="shake ease-in .5s";const e=setTimeout((()=>{clearTimeout(e),a.target.parentNode.style.animation=""}),600)}}),800),Ae=new c,we=()=>{ve&&ve.abort(),h.done(),pe.value=!1,_.value[_.value.length-1].showTools=!0},be=k([]),ye=async()=>{const e=await i(await l.getTags({kb_ids:a.botInfo.kb_ids}));be.value=e.tags};w((()=>{ye()})),Q((()=>a.botInfo),(()=>{ye()}),{immediate:!0,deep:!0});const Ce=async()=>{var e;if(!ne.value.trim().length)return;if(!ne.value.length)return void q.warn("正在聊天中...请等待结束");if(!(await ma()))return void q.error("模型设置错误，请先检查模型配置");if(!((ne.value.match(/@/g)||[]).length<=10))return void q.error("不可@超过10个");const t=ne.value;ne.value="",(e=>{_.value.push({question:e,type:"user"}),fe()})(t),pe.value=!0,null==(e=ge.value)||e.scrollIntoView(!0),ve=new AbortController;te(n+"/local_doc_qa/local_doc_chat",{method:"POST",headers:{"Content-Type":"application/json",Accept:["text/event-stream","application/json"],"Transfer-Encoding":"chunked",Connection:"keep-alive"},openWhenHidden:!0,body:JSON.stringify({user_id:o,user_info:s,bot_id:a.botInfo.bot_id,history:de.value,question:t,streaming:!1===B.value.capabilities.onlySearch,product_source:"saas"}),signal:ve.signal,onopen(e){(e=>{_.value.push({answer:"",question:e,onlySearch:B.value.capabilities.onlySearch,type:"ai",copied:!1,like:!1,unlike:!1,source:[],picList:null,showTools:!1})})(t),e.ok&&"text/event-stream"===e.headers.get("content-type")?(Ae.addChatSetting(B.value),h.start()):"application/json"===e.headers.get("content-type")&&h.add("Error 请检查模型是否配置正确")},onmessage(e){var a;const t=JSON.parse(e.data);if(200==(null==t?void 0:t.code)&&(null==t?void 0:t.response)&&"success"===t.msg)h.add(null==t?void 0:t.response.replaceAll("\n","<br/>")),fe();else{delete t.time_record.time_usage.retriever_search_by_milvus,Ae.addTime(t.time_record.time_usage),Ae.addToken(t.time_record.token_usage),Ae.addDate(Date.now())}(null==(a=null==t?void 0:t.source_documents)?void 0:a.length)&&(_.value[_.value.length-1].source=null==t?void 0:t.source_documents)},onclose(e){h.done(),ve.abort(),pe.value=!1,_.value[_.value.length-1].showTools=!0,_.value.at(-1).itemInfo=Ae.getChatInfo(),M((()=>{fe()}))},onerror(e){throw h.done(),ve.abort(),pe.value=!1,_.value[_.value.length-1].showTools=!0,M((()=>{fe()})),e}})},{showModal:_e}=f($()),{clearQAList:Se}=g(),xe=k(!1),ra=k(""),ua=k(""),da=async()=>{if(xe.value=!0,"download"===ua.value)try{const e=document.getElementById("chat-ul"),a=(await le(e,{useCORS:!0})).toDataURL("image/png"),t=document.createElement("a");t.style.display="none",t.href=a,t.setAttribute("download","chat-shot.png"),void 0===t.download&&t.setAttribute("target","_blank"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(a),q.success(p.downloadSuccessful),Promise.resolve()}catch(e){q.error(e.message||e.msg||"出错了")}else"delete"===ua.value&&Se();ua.value="",ra.value="",xe.value=!1,_e.value=!1},pa=X("checkSettingOk"),ma=async()=>await pa();let va=["md","txt","pdf","jpg","png","jpeg","doc","docx","xls","xlsx","ppt","pptx","jsonl","csv","eml"];const ga=e=>{if(!e)return!1;const a=e.split(".");if(a.length){const e=a.pop();return!!va.includes(e)}return!1},ha=e=>{ga(e.file_name)&&async function(e){try{N(null);const a=await i(await l.getFile({file_id:e.file_id})),t=e.file_name.split(".").pop(),s=function(e){const a=va.indexOf(e);return fa[a]}(t);if(H(t),N(`data:${s};base64,${a.base64_content}`),"txt"===t){const e=atob(a.base64_content),t=decodeURIComponent(escape(e));G(t),E(!0)}else E(!0)}catch(a){q.error(a.msg||"获取文件失败")}}(e)};let fa=["text/markdown","text/plain","application/pdf","image/jpeg","image/png","image/jpeg","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/jsonl","text/csv","message/rfc822"];return fe(),(a,l)=>{const s=re,o=R;return U(),b(F,null,[y("div",Ie,[y("div",Be,[y("div",je,[Te,T(" "+I(e.botInfo.bot_name),1)]),y("div",Fe,[y("ul",{id:"chat-ul",ref_key:"scrollDom",ref:ge},[y("div",De,[y("div",Re,[Le,y("p",{class:"question-text",innerHTML:e.botInfo.welcome_message},null,8,qe)])]),(U(!0),b(F,null,D(S(_),((e,a)=>{var l,o,n;return U(),b("li",{key:a},["user"===e.type?(U(),b("div",Ue,[Oe,y("p",Ee,I(e.question),1)])):(U(),b("div",He,[y("div",Qe,[Ve,e.onlySearch?V("",!0):(U(),b("p",{key:0,class:j(["question-text",[e.source.length||(null==(l=null==e?void 0:e.picList)?void 0:l.length)?"":"change-radius",e.showTools?"":"flashing"]])},[e.answer?(U(),Z(ce,{key:0,content:e.answer},null,8,["content"])):(U(),b("span",Ke,I(e.answer),1)),Object.keys((null==(o=null==e?void 0:e.itemInfo)?void 0:o.tokenInfo)||{}).length?(U(),Z(se,{key:2,"chat-item-info":e.itemInfo},null,8,["chat-item-info"])):V("",!0)],2))]),(null==(n=null==e?void 0:e.picList)?void 0:n.length)?(U(!0),b(F,{key:0},D(e.picList,((a,t)=>(U(),b("div",{key:a+t,class:j(["data-picList",e.source.length||t+1!==e.picList.length?"":"picList-radius"])},[C(s,{width:150,src:a,class:"responsive-image"},null,8,["src"])],2)))),128)):V("",!0),e.source.length?(U(),b(F,{key:1},[y("div",{class:j(["source-total",S(me).includes(a)?"":"source-total-last"])},["zh"===S(oe)?(U(),b("span",ze,"找到了"+I(e.source.length)+"个信息来源：",1)):(U(),b("span",Ye,"Found "+I(e.source.length)+" source of information",1)),K(C(Y,{name:"down",onClick:e=>(e=>{me.value.push(e)})(a)},null,8,["onClick"]),[[z,!S(me).includes(a)]]),K(C(Y,{name:"up",onClick:e=>(e=>{me.value=me.value.filter((a=>a!==e))})(a)},null,8,["onClick"]),[[z,S(me).includes(a)]])],2),K(y("div",Me,[(U(!0),b(F,null,D(e.source,((a,l)=>(U(),b("div",{key:l,class:"data-source"},[K(y("p",Xe,[y("span",Ze,I(S(t).dataSource)+I(l+1)+":",1),a.file_id.startsWith("http")?(U(),b("a",{key:0,href:a.file_id,target:"_blank"},I(a.file_name),9,We)):(U(),b("span",{key:1,class:j(["file",ga(a.file_name)?"filename-active":""]),onClick:e=>ha(a)},I(a.file_name),11,Pe)),K(C(Y,{name:"iconup",onClick:a=>((e,a)=>{e.source[a].showDetailDataSource=!1})(e,l)},null,8,["onClick"]),[[z,a.showDetailDataSource]]),K(C(Y,{name:"icondown",onClick:a=>((e,a)=>{e.source[a].showDetailDataSource=!e.source[a].showDetailDataSource})(e,l)},null,8,["onClick"]),[[z,!a.showDetailDataSource]])],512),[[z,a.file_name]]),C(W,{name:"sourceitem"},{default:L((()=>{var e;return[K(y("div",Ne,[y("p",{innerHTML:null==(e=a.content)?void 0:e.replaceAll("\n","<br/>")},null,8,Ge),y("p",Je,[y("span",$e,I(S(t).correlation),1),T(I(a.score),1)])],512),[[z,a.showDetailDataSource]])]})),_:2},1024)])))),128))],512),[[z,S(me).includes(a)]])],64)):V("",!0),e.showTools?(U(),b("div",ea,[y("div",{class:"reload-box",onClick:a=>(e=>{ne.value=e.question,Ce()})(e)},[C(Y,{name:"reload"}),y("span",ta,I(S(t).regenerate),1)],8,aa),y("div",la,[C(Y,{style:P({color:e.copied?"#4D71FF":""}),name:"copy",onClick:a=>(e=>{O(e.answer).then((()=>{e.copied=!e.copied,q.success(t.copySuccess,1);const a=setTimeout((()=>{clearTimeout(a),e.copied=!e.copied}),1e3)})).catch((()=>{q.error(t.copyFailed,1)}))})(e)},null,8,["style","onClick"]),C(Y,{style:P({color:e.like?"#4D71FF":""}),name:"like",onClick:a=>S(ke)(e,a)},null,8,["style","onClick"]),C(Y,{style:P({color:e.unlike?"#4D71FF":""}),name:"unlike",onClick:a=>(e=>{e.unlike=!e.unlike,e.like=!1})(e)},null,8,["style","onClick"])])])):V("",!0)]))])})),128)),K(y("div",sa,null,512),[[z,S(pe)]]),K(y("div",{ref_key:"stopBtn",ref:he,class:"stop-btn"},[C(o,{onClick:we},{icon:L((()=>[C(Y,{name:"stop",class:j(S(pe)?"loading":"")},null,8,["class"])])),default:L((()=>[T(" "+I(S(t).stop),1)])),_:1})],512),[[z,S(pe)]])],512)]),y("div",oa,[y("div",na,[C(ue,{"input-value":S(ne),"onUpdate:inputValue":l[0]||(l[0]=e=>x(ne)?ne.value=e:null),options:S(be),onSend:Ce},{default:L((()=>[C(o,{type:"primary",disabled:S(pe),onClick:Ce},{default:L((()=>[C(Y,{name:"sendplane"})])),_:1},8,["disabled"])])),_:1},8,["input-value","options"])])])]),e.botInfo.kb_ids&&e.botInfo.kb_ids.length?V("",!0):(U(),b("div",ia,[ca,y("p",null,I(S(p).bindKbtoPreview),1)])),C(m,{ref:"chatSettingForDialogRef"},null,512)]),C(ee,{content:S(ra),"confirm-loading":S(xe),onOk:da},null,8,["content","confirm-loading"])],64)}}}),[["__scopeId","data-v-572ca94d"]]),ua={class:"edit-detail"},da={class:"bots-chat-page"},pa=H(h({__name:"EditDetail",setup(e){const{curBot:a}=f(t()),l=k();return N("checkSettingOk",(()=>l.value.handleOk(null,"模型配置已自动保存"))),(e,t)=>(U(),b("div",ua,[C(Se,{ref_key:"botDetailEditRef",ref:l},null,512),y("div",da,[C(ra,{"bot-info":S(a),"chat-type":"edit"},null,8,["bot-info"])])]))}}),[["__scopeId","data-v-a50342fe"]]);export{pa as default};
